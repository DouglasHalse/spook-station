#:kivy 2.1.0

<EMFReaderWidget>:
    size_hint: (1,1)
    canvasOpacity: 0.5
    canvas.after:
        Color:
            rgba: 0, 0, 0, self.canvasOpacity
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        id: ledbox
        orientation: 'vertical'
        size_hint: (.7, 1)
        padding: 10
        BoxLayout:
            id: ledIndicator
            orientation: 'horizontal'
            size_hint: (1, .5)
            canvas:
                Color:
                    rgba: 0, 0, 0, 1
                Rectangle:
                    pos: self.pos
                    size: self.size
            BoxLayout:
                size_hint: (.1, 1)        
            BoxLayout:
                id: led0
                size_hint: (.2, 1)
                canvas:
                    Color:
                        rgba: 0, 1, 0, 1
                    Ellipse:
                        pos: self.pos
                        size: self.size
            BoxLayout:
                size_hint: (.1, 1)         
            BoxLayout:
                id: led1
                size_hint: (.2, 1)
                canvas:
                    Color:
                        rgba: 0, 1, 0, 1
                    Ellipse:
                        pos: self.pos
                        size: self.size
            BoxLayout:
                size_hint: (.1, 1)            
            BoxLayout:
                id: led2
                size_hint: (.2, 1)
                canvas:
                    Color:
                        rgba: 1, 1, 0, 1
                    Ellipse:
                        pos: self.pos
                        size: self.size
            BoxLayout:
                size_hint: (.1, 1)            
            BoxLayout:
                id: led3
                size_hint: (.2, 1)
                canvas:
                    Color:
                        rgba: 1, 0, 0, 1
                    Ellipse:
                        pos: self.pos
                        size: self.size
            BoxLayout:
                size_hint: (.1, 1)            
            BoxLayout:
                id: led4
                size_hint: (.2, 1)
                canvas:
                    Color:
                        rgba: 1, 0, 0, 1
                    Ellipse:
                        pos: self.pos
                        size: self.size
            BoxLayout:
                size_hint: (.1, 1)            
        Slider:
            id: ledSlider
            size_hint: 1, .5
            padding: (self.width * .2) * 0.5 + 13
            max: 4
            value: 0
            step: 1
            on_value: root.OnLedNumChanged(self.value)
    BoxLayout:
        orientation: 'vertical'
        size_hint: (.3, 1)
        padding: 10
        spacing: 5
        BoxLayout:
            size_hint: (1,1)
            orientation: 'horizontal'
            valign: 'right'
            BoxLayout:
                size_hint: (.7, 1)
            Button:
                id: muteButton
                text: 'Mute'
                on_press: root.OnMuteButtonChange()
                size_hint: (.3, 1)
        BoxLayout:
            size_hint: (1,1)
            orientation: 'horizontal'
            ToggleButton:
                id: fluctuationButton0
                text: '0'
                group: 'fluctuationMagnitudeButton'
                state: 'down'
                allow_no_selection: False
                on_press: root.OnFluctuationMagnitudeChanged(0)
            ToggleButton:
                id: fluctuationButton1
                text: '1'
                group: 'fluctuationMagnitudeButton'
                allow_no_selection: False
                on_press: root.OnFluctuationMagnitudeChanged(1)
            ToggleButton:
                id: fluctuationButton2
                text: '2'
                group: 'fluctuationMagnitudeButton'
                allow_no_selection: False
                on_press: root.OnFluctuationMagnitudeChanged(2)
        BoxLayout:
            size_hint: (1,1)
            orientation: 'horizontal'
            ToggleButton:
                id: fluctuationRateButton0
                text: 'L'
                group: 'fluctuationRateButton'
                state: 'down'
                allow_no_selection: False
                on_press: root.OnFluctuationRateChanged(0)
            ToggleButton:
                id: fluctuationRateButton1
                text: 'M'
                group: 'fluctuationRateButton'
                allow_no_selection: False
                on_press: root.OnFluctuationRateChanged(1)
            ToggleButton:
                id: fluctuationRateButton2
                text: 'H'
                group: 'fluctuationRateButton'
                allow_no_selection: False
                on_press: root.OnFluctuationRateChanged(2)
            

<GenericDeviceWidget>:
    size_hint: (1,1)

<BaseDeviceInfoLableWidget>:
    Label:
        id: deviceName
        text: 'deviceName' 

<BaseDeviceConnectionIndicatorWidget>:
    Image:
        id: deviceConnectionIndicator
        source: 'Images/ghost_red.png'
        size_hint: (1, 1)
        allow_stretch: False
        keep_ratio: True

<BaseDeviceInfoWidget>:
    id: info_box
    orientation: 'vertical'
    size_hint: (None, 1)
    width: '96dp'
    padding: 10

<DeviceRowWidget>:
    orientation: 'horizontal'
    size_hint_min: (1, 0.7)
    size_hint: (1, None)
    height: '96dp'
    canvas:
        Color:
            rgba: 0.2, 0.2, 0.2, 1
        Rectangle:
            pos: self.pos
            size: self.size

<ManageDevicesPopup>:
    id: manageDevicesPopup
    title: 'Manage devices'
    size_hint: (0.5, 0.77)
    

    GridLayout:
        id: manageDevicesAddedDevicesGrid
        cols: 1
        size_hint: (1, 1)
        spacing: [10, 10]
        
        GridLayout:
            id: manageDevicesAddedDevicesGridHeader
            cols: 2
            size_hint: (1, None)
            padding: [10, 0, 10, 0]
            height: '50dp'
            canvas:
                Color:
                    rgba: 0.4, 0.4, 0.4, 1.0
                Rectangle:
                    pos: self.pos
                    size: self.size
            
            Label:
                id: manageDevicesAddedDevicesGridHeaderDeviceName
                text: 'Device Name'
                halign: 'left'
                valign: 'middle'
                size_hint: None, None
                text_size: self.size
                width: '130dp'
                height: '50dp'

            Label:
                id: manageDevicesAddedDevicesGridHeaderDeviceType
                text: 'Device Type'
                halign: 'left'
                valign: 'middle'
                size_hint: None, None
                text_size: self.size
                width: '130dp'
                height: '50dp'

        ScrollView:
            id: manageDevicesAddedDevicesGridList
            size_hint: (1, None)
            height: '200dp'
            do_scroll_x: False
            do_scroll_y: True

            GridLayout:
                id: manageDevicesAddedDevicesGridListContent
                cols: 1
                size_hint_y: None
                size_hint_x: 1
                height: self.minimum_height
                row_default_height: '50dp'
                
        BoxLayoutButton:
            id: manageDevicesAddDeviceBox
            size_hint: (None, None)
            height: '30dp'
            width: '130dp'
            on_press: root.OnAddDeviceButtonPressed()
            canvas:
                Color:
                    rgba: 0.4, 0.4, 0.4, 1.0
                Rectangle:
                    pos: self.pos
                    size: self.size
            
            Label:
                id: manageDevicesAddDeviceLabel
                text: 'Add new device'
                size_hint: (1, 1)


<ManageDevicesPopupDevice>:
    orientation: 'horizontal'
    size_hint: (1, None)
    height: '50dp'
    padding: [10, 0, 10, 0]
    canvas:
        Color:
            rgba: 0.2, 0.2, 0.2, 0.5
        Rectangle:
            pos: self.pos
            size: self.size
    
    Label:
        id: manageDeviceAddedDeviceName
        text: 'deviceName'
        halign: 'left'
        valign: 'middle'
        size_hint: None, None
        text_size: self.size
        width: '130dp'
        height: '50dp'
    
    Label:
        id: manageDeviceAddedDeviceType
        text: 'deviceType'
        halign: 'left'
        valign: 'middle'
        size_hint: None, None
        text_size: self.size
        width: '130dp'
        height: '50dp'
    
    Button:
        id: manageDeviceAddedDeviceRemoveButton
        text: 'Manage'
        halign: 'center'
        valign: 'middle'
        size_hint: None, None
        text_size: self.size
        width: '100dp'
        height: '50dp'
        on_press: root.OnManageDeviceButtonPressed(root.ids.manageDeviceAddedDeviceName.text)

<ManageDevicePopup>:
    id: manageDevicePopup
    title: 'Manage device'
    height: '320dp'
    width: '300dp'
    size_hint: None, None
    GridLayout:
        cols: 1
        padding: [10, 10, 10, 10]
        spacing: [5, 5]

        BoxLayout:
            id: manageDeviceNameLabel
            size_hint: 1, None
            height: '20dp'
            Label:
                id: addDeviceNameLabel
                halign: 'left'
                text_size: self.size
                text: 'Device Name:'
                
        TextInput:
            id: manageDeviceNameInput
            size_hint: 1, None
            height: '40dp'
            font_size: '20dp'
            multiline: False
            focus: True
            on_text_validate: root.OnConfirmButtonPressed()
        
        BoxLayout:
            id: manageDeviceTypeLabel
            size_hint: 1, None
            height: '20dp'
            Label:
                halign: 'left'
                text_size: self.size
                id: manageDeviceTypeLabel
                text: 'Device Type:'
                size_hint: (1, 1)
        
        Spinner:
            id: manageDeviceTypeSpinner
            size_hint: 1, None
            height: '40dp'
            text: 'UNDEFINED'
            values: ['UNDEFINED']
        
        BoxLayout:
            id: manageDeviceButtonsSpacer
            size_hint: 1, None
            height: '40dp'
        
        GridLayout:
            id: manageDeviceButtonsGrid
            cols: 4
            size_hint: 1, None
            height: '50dp'
            spacing: [10, 10]

            BoxLayoutButton:
                id: manageDeviceRemoveButton
                size_hint: 1, None
                height: '50dp'
                width: '70dp'
                on_press: root.OnRemoveButtonPressed()
                canvas:
                    Color:
                        rgba: 1.0, 0.0, 0.0, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                
                Label:
                    id: manageDeviceRemoveLabel
                    text: 'Remove'
                    size_hint: (1, 1)
            
            BoxLayout:
                id: manageDeviceRemoveButtonSpacer
                size_hint: None, None
                height: '50dp'
                width: '30dp'

            BoxLayoutButton:
                id: manageDeviceCancelButton
                size_hint: 1, None
                height: '50dp'
                width: '70dp'
                on_press: root.dismiss()
                canvas:
                    Color:
                        rgba: 0.7, 0.7, 0.7, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                
                Label:
                    id: manageDeviceCancelLabel
                    text: 'Cancel'
                    size_hint: (1, 1)

            BoxLayoutButton:
                id: manageDeviceConfirmButton
                size_hint: 1, None
                height: '50dp'
                width: '70dp'
                on_press: root.OnConfirmButtonPressed()
                canvas:
                    Color:
                        rgba: 0.7, 0.7, 0.7, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                
                Label:
                    id: manageDeviceRemoveLabel
                    text: 'Confirm'
                    size_hint: (1, 1)

<AddDevicePopup>:
    id: addDevicePopup
    title: 'Add a device'
    height: '320dp'
    width: '300dp'
    size_hint: None, None
    GridLayout:
        cols: 1
        padding: [10, 10, 10, 10]
        spacing: [10, 10]

        BoxLayout:
            id: addDeviceNameLabel
            size_hint: 1, None
            height: '20dp'
            Label:
                id: addDeviceNameLabel
                halign: 'left'
                text_size: self.size
                text: 'Device Name:'
                
        TextInput:
            id: addDeviceNameInput
            size_hint: 1, None
            height: '40dp'
            font_size: '20dp'
            multiline: False
            focus: True
            on_text_validate: root.AddDevice()
        
        BoxLayout:
            id: addDeviceTypeLabel
            size_hint: 1, None
            height: '20dp'
            Label:
                halign: 'left'
                text_size: self.size
                id: addDeviceTypeLabel
                text: 'Device Type:'
                size_hint: (1, 1)
        
        Spinner:
            id: addDeviceTypeSpinner
            size_hint: 1, None
            height: '40dp'
            text: 'UNDEFINED'
            values: ['UNDEFINED']
        
        BoxLayout:
            id: addDeviceAddButtonSpacer
            size_hint: 1, None
            height: '20dp'
        
        BoxLayoutButton:
            id: addDeviceAddButton
            size_hint: 1, None
            height: '50dp'
            on_press: root.AddDevice()
            canvas:
                Color:
                    rgba: 0.7, 0.7, 0.7, 1
                Rectangle:
                    pos: self.pos
                    size: self.size
            Label:
                id: addDeviceAddLabel
                text: 'Add Device'
                size_hint: (1, 1)

<ErrorMessagePopup>:
    id: errorMessagePopup
    title: 'Error'
    size_hint: (0.5, 0.5)
    BoxLayout:
        id: errorMessagePopupBox
        orientation: 'vertical'
        size_hint: (1, 1)
        Label:
            id: errorMessagePopupLabel
            text: 'Error message'
            size_hint: (1, 1)
        Button:
            id: errorMessagePopupButton
            text: 'OK'
            size_hint: (1, 1)
            on_press: root.dismiss()

<SpookStationWidget>:
    orientation: "vertical"
    BoxLayout:
        canvas:
            Color:
                rgba: .8, .8, .8, 1
            Rectangle:
                pos: self.pos
                size: self.size
        orientation: "horizontal"
        size_hint: 1, None
        height: '48dp'
        GridLayout:
            id: leftIconGrid
            orientation: "lr-tb"
            rows: 1
            size_hint: 1, 1

            Image:
                id: icon_1
                width: '48dp'
                size_hint_x: None
                source: 'Images/fisk.png'
                color: 'red'

            Image:
                id: icon_2
                width: '48dp'
                size_hint_x: None
                source: 'Images/spook.png'
                color: 'green'
            
            Image:
                id: icon_3
                width: '48dp'
                size_hint_x: None
                source: 'Images/fisk.png'
                color: 'white'
        
        GridLayout:
            id: rightIconGrid
            orientation: "rl-tb"
            rows: 1
            size_hint: 1, 1

            ImageButton:
                id: manageDevicesButton
                width: '48dp'
                size_hint_x: None
                source: 'Images/manage_devices.png'
                color: 'white'
                on_press: root.OnManageDevicesButtonPressed()

            GridLayout:
                id: bytesReceivedGrid
                cols:2
                width: '130dp'
                size_hint_x: None
                Image:
                    id: bytesReceivedImage
                    width: '32dp'
                    size_hint_x: None
                    source: 'Images/downArrow.png'
                    color: 'white'
                Label:
                    id: bytesReceivedLabel
                    text: '0 B/s'
                    size_hint: (1, 1)
                    color: 'black'
                    bold: True

            GridLayout:
                id: bytesSentGrid
                cols:2
                width: '130dp'
                size_hint_x: None
                Image:
                    id: bytesSentImage
                    width: '32dp'
                    size_hint_x: None
                    source: 'Images/upArrow.png'
                    color: 'white'
                Label:
                    id: bytesSentLabel
                    text: '0 B/s'
                    size_hint: (1, 1)
                    color: 'black'
                    bold: True
    
    GridLayout:
        id: deviceList
        cols: 1
        spacing: 10
        size_hint:(1,1)
        canvas:
            Color:
                rgba: 0, 0.3, 0, 1
            Rectangle:
                pos: self.pos
                size: self.size